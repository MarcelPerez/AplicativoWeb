<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Sistema Inspección Aire</title>
    <link rel="stylesheet" href="login.css" />
    <link rel="apple-touch-icon" href="./../sistema/images/Icon.png" />
    <link rel="icon" type="image/png" href="./../sistema/images/Icon.png" />
  </head>
  <body>
    <div class="login-container" id="login-container">
      <h2>
        Sistema Inspección de Aire<br />
        <div class="clock">
          <span id="hours"></span>:<span id="minutes"></span>:<span
            id="seconds"
          ></span>
          <span id="meridiem"></span>
        </div>
      </h2>

      <div class="form-group" id="login">
        <input
          id="username"
          type="text"
          class="form-control"
          name="username"
          placeholder="Usuario"
        />
        <input
          id="password"
          type="password"
          class="form-control"
          name="password"
          placeholder="Contraseña"
        />
      </div>
      <div class="botones">
        <button id="btnIniciarSesion" class="boton" onclick="initial()">
          Iniciar Sesión
        </button>
        <button id="btnRegistrarme" class="boton" onclick="registrarme()">
          Registrarme
        </button>
        <button
          id="btnOlvidePassword"
          class="boton"
          onclick="showForgetPasswordForm()"
        >
          Olvidé Contraseña
        </button>
        <button id="btnSalir" class="boton" onclick="salir()">
          Salir del Sistema
        </button>
      </div>
    </div>

    <div class="container" id="containerRegistro">
      <form class="registro-form">
        <h2>Registro de Usuario</h2>

        <label for="primer-nombre">*Primer Nombre:</label>
        <input type="text" id="primer-nombre" name="primer-nombre" />

        <label for="segundo-nombre">Segundo Nombre:</label>
        <input type="text" id="segundo-nombre" name="segundo-nombre" />

        <label for="primer-apellido">*Primer Apellido:</label>
        <input type="text" id="primer-apellido" name="primer-apellido" />

        <label for="segundo-apellido">*Segundo Apellido:</label>
        <input type="text" id="segundo-apellido" name="segundo-apellido" />

        <label for="tipo-usuario">*Tipo de Usuario:</label>
        <select id="tipo-usuario" name="tipo-usuario">
          <option value="" disabled selected>Seleccionar</option>
          <option value="estudiante">Estudiante</option>
          <option value="profesor">Profesor</option>
        </select>

        <button
          class="btn-anterior"
          id="btn-anteriorRegistro1"
          type="button"
          onclick="anterior(1)"
        >
          Anterior
        </button>
        <button
          class="btn-continuar"
          id="btn-continuarRegistro1"
          type="button"
          onclick="siguiente(1)"
        >
          Continuar
        </button>
      </form>
    </div>

    <div class="container2" id="containerRegistro2">
      <form class="registro-form">
        <h2>Registro de Usuario</h2>

        <label for="pregunta-seguridad-1">*Pregunta de seguridad 1:</label>
        <select
          id="pregunta-seguridad-1"
          name="pregunta-seguridad-1"
          onchange="changePreguntaSeguridad(2)"
        >
          <option value="" disabled selected>Seleccionar</option>
        </select>

        <label for="respuesta-pregunta-1">*Respuesta 1:</label>
        <input
          type="text"
          id="respuesta-pregunta-1"
          name="respuesta-pregunta-1"
          disabled
        />

        <label for="pregunta-seguridad-2">*Pregunta de seguridad 2:</label>
        <select
          id="pregunta-seguridad-2"
          name="pregunta-seguridad-2"
          disabled
          onchange="changePreguntaSeguridad(3)"
        >
          <option value="" disabled selected>Seleccionar</option>
        </select>

        <label for="respuesta-pregunta-2">*Respuesta 2:</label>
        <input
          type="text"
          id="respuesta-pregunta-2"
          name="respuesta-pregunta-2"
          disabled
        />

        <label for="pregunta-seguridad-3">*Pregunta de seguridad 3:</label>
        <select
          id="pregunta-seguridad-3"
          name="pregunta-seguridad-3"
          disabled
          onchange="changePreguntaSeguridad(4)"
        >
          <option value="" disabled selected>Seleccionar</option>
        </select>

        <label for="respuesta-pregunta-3">*Respuesta 3:</label>
        <input
          type="text"
          id="respuesta-pregunta-3"
          name="respuesta-pregunta-3"
          disabled
        />
        <button
          class="btn-anterior"
          id="btn-anteriorRegistro2"
          type="button"
          onclick="anterior(2)"
        >
          Anterior
        </button>
        <button class="btn-continuar" type="button" onclick="siguiente(2)">
          Continuar
        </button>
      </form>
    </div>

    <div class="container3" id="containerRegistro3">
      <form class="registro-form3">
        <h2>Registro de Usuario</h2>

        <label for="usuario">*Usuario:</label>
        <input type="text" id="usuario" name="usuario" />

        <label for="contrasena">*Contraseña:</label>
        <input type="password" id="contrasena" name="contrasena" />

        <button
          class="btn-anterior"
          id="btn-anteriorRegistro3"
          type="button"
          onclick="anterior(3)"
        >
          Anterior
        </button>
        <button
          class="btn-continuar"
          type="button"
          onclick="registrarUsuario()"
        >
          Aceptar
        </button>
        <button
          type="button"
          id="toggleButton"
          onclick="togglePasswordVisibility()"
        >
          Mostrar contraseña
        </button>
      </form>
    </div>

    <div id="olvideCredencial" class="olvideCredencial">
      <div id="forgetPasswordForm" class="forget-password-form">
        <div id="security-questions" class="security-questions">
          <h2>Recuperar Contraseña</h2>
          <div class="form-group">
            <label for="usuario">Ingrese su usuario:</label>
            <input style="margin-top: 10px" id="usuarioForget" type="text" />
          </div>
          <button class="comprobarUsuario" onclick="confirmarUsuario()">
            Confirmar Usuario
          </button>
          <button class="nuevoUsuario" onclick="nuevoUsuario()">
            Nuevo Usuario
          </button>
          <div id="preguntasSeguridad">
            <div class="form-group">
              <label for="question1" id="lblQuestion1"></label>
              <input id="question1" type="text" class="form-control" disabled />
            </div>
            <div class="form-group">
              <label for="question2" id="lblQuestion2"></label>
              <input id="question2" type="text" class="form-control" disabled />
            </div>
            <div class="form-group">
              <label for="question3" id="lblQuestion3"></label>
              <input id="question3" type="text" class="form-control" disabled />
            </div>
          </div>
        </div>
        <div id="nuevaPasswordGroup" class="nuevaPasswordGroup" style="display: none;">
          <h2>Cambio de Contraseña</h2>
          <label for="newPassword" id="lblNewPassword">Nueva Contraseña:</label>

          <input
            id="newPassword"
            type="password"
            class="newPassword"
            name="newPassword"
            placeholder="Nueva Contraseña"
          />

          <label for="newPassword2" id="lblNewPassword2"
            >Confirmar Contraseña:</label
          >

          <input
            id="newPassword2"
            type="password"
            class="newPassword"
            name="newPassword2"
            placeholder="Confirmar Contraseña"
          />
          
        <button class="btnCancelarNuevaPassword" onclick="cancelarNuevaPassword()">
          Cancelar
        </button>
        <button class="btnAceptarNuevaPassword" onclick="establecerNuevaPassword()">
          Aceptar
        </button>
        </div>
        <div id="checkUser" class="button-container">
          <button class="cancel-button" onclick="goBackToLoginForm()">
            Cancelar
          </button>
          <button class="accept-button" onclick="checkSecurityAnswers()">
            Aceptar
          </button>
        </div>
        
      </div>
    </div>

    <div id="alertBox" class="alert-box">
      <center><p id="message"></p></center>
      <p id="usuarioCorrect" style="padding: 10px"></p>

      <button id="closeAlert">Cerrar</button>
    </div>

    <div id="alertBoxCorrect" class="alert-boxCorrect">
      <center><p id="messageCorrect"></p></center>
      <p id="usuarioCorrecto"></p>

      <br /><br /><br />
      <button id="closeAlertCorrect">Aceptar</button>
    </div>

    <script src="login.js"></script>
    <!-- RELOJ: -->
    <script src="clock.js"></script>
    <!-- ENCRIPTAR  -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>
    <script src="encryp.js"></script>

    <!-- Llenar las preguntas de seguridad -->
    <script src="getPreguntasSeguridad.js"></script>

    <!-- Registrar Usuario: -->
    <script src="registrar.js"></script>

    <!-- Alertas: -->
    <script src="alert.js"></script>

    <!-- Preguntas de Seguridad | Cambiar: -->
    <script src="preguntasSeguridad.js"></script>

    <!-- Forget Password: -->
    <script src="forgetPassword.js"></script>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.0/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/forge/0.8.2/forge.all.min.js"></script>
    <script>
      function generateHash() {
        const currentTimestamp = Math.floor(Date.now() / 1000);
        const apiKey = "cc9ilwz6xvtg2yg1f8a0hk0ilvydgga4";
        var plainText = "api-key" + apiKey + "t" + currentTimestamp;
        var plainText2 = "?api-key=" + apiKey + "&t=" + currentTimestamp;

        var secretKey = "rbni6y4u50qjafr135wv4ilzf6whxinv";

        var hmac = forge.hmac.create();
        hmac.start("sha256", secretKey);
        hmac.update(plainText);
        var hashText = hmac.digest().toHex();

        const urlApi = "https://api.weatherlink.com/v2/stations";

        console.log(urlApi + plainText2 + "&api-signature=" + hashText);
      }
      // generateHash();
    </script>
  </body>
</html>
